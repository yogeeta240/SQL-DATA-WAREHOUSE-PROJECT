/*
======================================================================
Create Database and Schemas
======================================================================
Script purpose:
This script creates a new database named 'DataWareHouse'after checking if it is already existing.
If the database exists,it is dropped and recreated . Additionally the script setups three schemas within the database : 'Bronze','Silver','Gold'.

Warning:
Running this scripts will drop the entire database if it already exists.
All the data in the database will be deleted permanently.
Proceed with caution and ensure u have proper backup before running this script.
*/


USE master;
GO
-- Drop and recreate the 'DataWareHouse' database
IF EXISTS(SELECT 1 FROM sys.databases WHERE name='DataWareHouse')
BEGIN
     ALTER DATABASE DataWareHouse SET SINGLE_USER WITH ROLLBACK IMMEDIATE;
     DROP DATABASE DataWareHouse;
END;
GO

-- CREATE THE 'DataWareHouse' database
CREATE DATABASE DataWareHouse;
GO

USE DataWareHouse;
GO

--CREATE SCHEMAS
CREATE SCHEMA Bronze;
GO

CREATE SCHEMA Silver;
GO

CREATE SCHEMA Gold;
GO
